<!-- app/views/care_methods/new.html.erb -->

<style>
  body {
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: calc(100vh - 160px); /* 100px of header + 60px of footer */
    padding-top: 100px; 
    padding-bottom: 60px; /* Add padding at the bottom of body equal to the footer height */
  }

  #new-care-method-form {
    max-width: 80%;
    overflow-y: auto;
  }

  .form-group {
    margin-bottom: 10px;
  }
</style>

<div class="container mt-4">
  <h1 class="mb-4">New Care Method</h1>

  <%= form_with model: @care_method, local: true, html: { class: 'p-3 bg-light rounded-3' } do |form| %>
    <% if @care_method.errors.any? %>
      <div id="error_explanation" class="alert alert-danger">
        <h2><%= pluralize(@care_method.errors.count, "error") %> prohibited this care_method from being saved:</h2>

        <ul>
          <% @care_method.errors.full_messages.each do |message| %>
            <li><%= message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="form-group">
      <%= form.label :name, class: "form-label" %>
      <%= form.text_field :name, required: false, class: "form-control" %>
    </div>

    <div class="form-group">
      <%= form.label :description, class: "form-label" %>
      <%= form.text_field :description, required: false, class: "form-control" %>
    </div>

    <div class="form-group">
      <%= form.label :link, class: "form-label" %>
      <%= form.text_field :link, required: false, class: "form-control" %>
    </div>

    <div class="form-group">
      <%= form.label :symptom_ids, class: "form-label" %>
      <div class="accordion" id="symptoms-accordion">
        <% @symptoms.group_by(&:group_name).each_with_index do |(group_name, symptoms), index| %>
          <div class="accordion-item">
            <h2 class="accordion-header" id="heading<%= index %>">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse<%= index %>" aria-expanded="false" aria-controls="collapse<%= index %>">
                <%= group_name %>
              </button>
            </h2>
            <div id="collapse<%= index %>" class="accordion-collapse collapse" aria-labelledby="heading<%= index %>" data-bs-parent="#symptoms-accordion">
              <div class="accordion-body">
                <% symptoms.each do |symptom| %>
                  <div class="form-check">
                    <%= form.check_box :symptom_ids, { multiple: true, id: "symptom-#{symptom.id}", class: 'form-check-input' }, symptom.id, nil %>
                    <%= form.label "symptom_ids_#{symptom.id}", symptom.name_with_pain_type, for: "symptom-#{symptom.id}", class: 'form-check-label' %>
                  </div>
                <% end %>
              </div>
            </div>
          </div>
        <% end %>
      </div>
    </div>

    <div class="actions mt-3">
      <%= form.submit "Submit", class: "btn btn-primary" %>
    </div>
  <% end %>
</div>